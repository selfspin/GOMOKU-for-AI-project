import numpy as np
import nn

x = np.array([[0.],
              [1.],
              [0.],
              [1.],
              [1.],
              [1.],
              [0.],
              [0.],
              [0.],
              [0.],
              [1.],
              [1.],
              [0.],
              [0.],
              [0.],
              [0.],
              [0.],
              [1.],
              [1.],
              [1.],
              [1.],
              [0.],
              [0.],
              [0.],
              [1.],
              [1.],
              [1.],
              [1.],
              [1.],
              [1.5],
              [0.],
              [1.],
              [1.],
              [1.],
              [1.],
              [1.],
              [0.],
              [0.],
              [1.],
              [1.],
              [1.],
              [0.],
              [0.],
              [0.],
              [0.],
              [1.],
              [1.],
              [1.],
              [1.],
              [1.],
              [1.],
              [0.],
              [1.],
              [1.],
              [1.],
              [1.],
              [0.],
              [0.],
              [0.],
              [1.],
              [1.],
              [1.],
              [1.],
              [1.],
              [2.],
              [0.],
              [1.],
              [1.],
              [1.],
              [1.],
              [1.],
              [0.],
              [0.],
              [1.],
              [1.],
              [1.],
              [1.],
              [1.],
              [0.],
              [0.],
              [1.],
              [1.],
              [1.],
              [1.],
              [1.],
              [4.],
              [0.],
              [1.],
              [1.],
              [1.],
              [1.],
              [0.],
              [0.],
              [0.],
              [1.],
              [1.],
              [1.],
              [1.],
              [1.],
              [1.],
              [0.],
              [1.],
              [1.],
              [1.],
              [1.],
              [1.],
              [3.5],
              [0.],
              [1.],
              [1.],
              [1.],
              [1.],
              [1.],
              [6.5],
              [0.],
              [1.],
              [1.],
              [1.],
              [1.],
              [1.],
              [5.],
              [0.],
              [1.],
              [1.],
              [1.],
              [1.],
              [1.],
              [7.5],
              [0.],
              [1.],
              [1.],
              [1.],
              [1.],
              [1.],
              [2.5],
              [0.],
              [1.],
              [1.],
              [1.],
              [1.],
              [0.],
              [0.],
              [0.],
              [1.],
              [1.],
              [1.],
              [1.],
              [0.],
              [0.],
              [0.],
              [0.],
              [0.],
              [0.],
              [1.],
              [1.],
              [0.],
              [0.],
              [0.],
              [0.],
              [0.],
              [0.],
              [0.],
              [0.],
              [0.],
              [0.],
              [0.],
              [0.],
              [1.],
              [1.],
              [1.],
              [0.],
              [0.],
              [0.],
              [0.],
              [1.],
              [1.],
              [1.],
              [0.],
              [0.],
              [0.],
              [0.],
              [1.],
              [1.],
              [0.],
              [0.],
              [0.],
              [0.],
              [0.],
              [1.],
              [1.],
              [1.],
              [1.],
              [0.],
              [0.],
              [0.],
              [1.],
              [1.],
              [1.],
              [1.],
              [1.],
              [0.5],
              [0.],
              [1.],
              [1.],
              [0.],
              [0.],
              [0.],
              [0.],
              [0.],
              [1.],
              [1.],
              [1.],
              [1.],
              [1.],
              [4.5],
              [0.],
              [1.],
              [1.],
              [1.],
              [0.],
              [0.],
              [0.],
              [0.],
              [1.],
              [1.],
              [1.],
              [0.],
              [0.],
              [0.],
              [0.],
              [0.],
              [0.],
              [0.],
              [0.],
              [0.],
              [0.],
              [0.],
              [0.],
              [0.],
              [0.],
              [0.],
              [0.],
              [0.],
              [0.],
              [1.],
              [1.],
              [0.],
              [0.],
              [0.],
              [0.],
              [0.],
              [1.],
              [1.],
              [1.],
              [1.],
              [1.],
              [1.5],
              [0.],
              [1.],
              [1.],
              [1.],
              [1.],
              [1.],
              [6.],
              [0.],
              [1.],
              [1.],
              [1.],
              [1.],
              [1.],
              [6.5],
              [0.],
              [1.],
              [1.],
              [1.],
              [1.],
              [1.],
              [1.5],
              [0.],
              [1.],
              [1.],
              [1.],
              [1.],
              [0.],
              [0.],
              [0.],
              [1.],
              [1.],
              [1.],
              [1.],
              [1.],
              [3.],
              [0.],
              [1.],
              [1.],
              [1.],
              [1.],
              [1.],
              [1.],
              [1.],
              [1.],
              [0.]])
par = np.load('para.npy', allow_pickle=True)
par = par.reshape(1)[0]
net = nn.NN(params=par)
print(net.full_forward_propagation(x, par)[0])

f = np.load('replay_feature.npy', allow_pickle=True)
y = np.load('replay_target.npy', allow_pickle=True)
_=net.train(f,y,100)
